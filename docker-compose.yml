services:
    users-db:
        container_name: postgres
        image: postgres:latest
        env_file:
            - .env
        environment:
            POSTGRES_USER: ${POSTGRES_USER}
            POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
            POSTGRES_DB: ${POSTGRES_DB_NAME}
        ports:
            - "${POSTGRES_PORT}:${POSTGRES_DOCKER_PORT}"
        networks:
            - app-network
        volumes:
            - users-data:/var/lib/postgresql/users-data
    rabbitmq:
        image: rabbitmq:latest
        env_file:
            /src/NotificationApi/Api/.env
        hostname: ${RABBITMQ__HOST}
        restart: always
        environment:
            - RABBITMQ_DEFAULT_USER=${RABBITMQ__USERNAME}
            - RABBITMQ_DEFAULT_PASS=${RABBITMQ__PASSWORD}
            - RABBITMQ_SERVER_ADDITIONAL_ERL_ARGS=-rabbit disk_free_limit 2147483648
        volumes:
            - rabbitmq:/var/lib/rabbitmq
        ports:
            - ${RABBITMQ_UI_PORTS}
            - ${RABBITMQ_MESSAGING_PORTS}
volumes:
    users-data:
    rabbitmq:

networks:
    app-network:
        driver: bridge